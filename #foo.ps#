gsave
tile-H-encloser-points-2 0 get aload pop translate tile-H-2
grestore


gsave
tile-H-encloser-points-2 dup 0 get exch dup 2 get exch 0 get vsub vadd aload pop translate tile-H-2
grestore

gsave
tile-H-encloser-points-2 dup 0 get exch dup 4 get exch 0 get vsub dup vadd vadd aload pop translate -120 rotate tile-H-2
grestore

gsave
tile-H-encloser-points-2 dup dup 2 get exch 0 get vsub exch dup 4 get exch tile-H-encloser-points-2 0 get
 vsub vadd tile-F-encloser-points-2 dup 2 get

 exch 1 get vsub 120 vrot vadd aload pop translate 180 rotate tile-T-2
grestore

gsave
3
{
    tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate

    gsave
    tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-P-encloser-points-2 dup 0 get exch 2 get vsub vadd aload pop translate tile-F-2
    grestore

    tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-H-encloser-points-2 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate

}
repeat
grestore

gsave
2 {
    tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate
    gsave
    tile-P-encloser-points-2 dup 0 get exch 2 get vsub aload pop translate tile-P-2
    grestore
    tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-H-encloser-points-2 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate
}
repeat
tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate
    gsave
    180 rotate tile-P-2
    grestore
grestore


=====

{


gsave tile-H-encloser-points-1 0 get aload pop translate tile-H-1 grestore


 gsave tile-H-encloser-points-1 dup 0 get exch dup 2 get exch 0 get vsub vadd aload pop translate tile-H-1 grestore


 gsave tile-H-encloser-points-1 dup 0 get exch dup 4 get exch 0 get vsub dup vadd vadd aload pop translate -120 rotate tile-H-1 grestore


 gsave tile-H-encloser-points-1 dup dup 2 get exch 0 get vsub exch dup 4 get exch tile-H-encloser-points-1 0 get vsub vadd tile-F-encloser-points-1 dup 2 get exch 1 get vsub 120 vrot vadd aload pop translate 180 rotate tile-T-1 grestore

 gsave 
3 {tile-H-encloser-points-1 dup 2 get exch 0 get vsub aload pop translate 
gsave tile-H-encloser-points-1 dup 2 get exch 0 get vsub tile-P-encloser-points-1 dup 0 get exch 2 get vsub vadd aload pop translate tile-F-1 grestore
 tile-H-encloser-points-1 dup 2 get exch 0 get vsub tile-H-encloser-points-1 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate} repeat
 grestore


 gsave 2 {tile-H-encloser-points-1 dup 2 get exch 0 get vsub aload pop translate gsave tile-P-encloser-points-1 dup 0 get exch 2 get vsub aload pop translate tile-P-1 grestore tile-H-encloser-points-1 dup 2 get exch 0 get vsub tile-H-encloser-points-1 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate} repeat tile-H-encloser-points-1 dup 2 get exch 0 get vsub aload pop translate gsave 180 rotate tile-P-1 grestore grestore}
GS<1>


{
    gsave tile-H-encloser-points-2 0 get aload pop translate tile-H-2 grestore

    gsave tile-H-encloser-points-2 dup 0 get exch dup 2 get exch 0 get vsub vadd aload pop translate tile-H-2 grestore

    gsave tile-H-encloser-points-2 dup 0 get exch dup 4 get exch 0 get vsub dup vadd vadd aload pop translate -120 rotate tile-H-2 grestore

    gsave
    tile-H-encloser-points-2 dup dup  % HEP HEP HEP
    2 get                             % HEP HEP H2
    exch 0 get                        % HEP H2 H0
    vsub                              % HEP H2-H0
    exch dup                          % H2-H0 HEP HEP
    4 get exch 0 get vsub             % H2-H0 H4-H0
    vadd                              % H2-H0+H4-H0
    tile-F-encloser-points-2 dup      % H2-H0+H4-H0 FEP FEP
    2 get exch 1 get vsub             % H2-H0+H4-H0 F2-F1
    120 vrot
 vadd aload pop translate 180 rotate tile-T-2 grestore

    gsave 3
    {
        tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate
        gsave
        tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-P-encloser-points-2 dup 0 get exch 2 get vsub vadd aload pop translate tile-F-2
        grestore
        tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-H-encloser-points-2 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate
    } repeat
    grestore
    gsave
    2 {
        tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate
        gsave
        tile-P-encloser-points-2 dup 0 get exch 2 get vsub aload pop translate tile-P-2
        grestore
        tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-H-encloser-points-2 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate
    } repeat
    tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate
    gsave
    180 rotate tile-P-2
    grestore
    grestore
}



gsave
tile-T-encloser-points-2
aload pop
vadd vadd 1 3 div vmul 

tile-H-encloser-1 0 get tile-H-encloser-1 2 get tile-H-encloser-1 4 get vadd vadd 1 3 div vmul vsub aload pop translate tile-H-1 grestore}


%%%%
10 -3 translate

    brown-colors
    gsave tile-H-encloser-points-2 0 get aload pop translate tile-H-2 

grestore

    red-colors
    gsave tile-H-encloser-points-2 2 get aload pop translate tile-H-2 

grestore

    white-colors
    gsave 


tile-H-encloser-points-2 dup dup 2 get
exch dup 4 get exch 0 get vsub
vadd
gsave aload pop translate -120 rotate grestore
 

 dup vadd
 vadd aload pop translate -120 rotate tile-H-2 grestore

    gsave tile-H-encloser-points-2 dup dup 2 get exch 0 get vsub exch dup 4 get exch 0 get vsub vadd tile-F-encloser-points-2 dup 2 get exch 1 get vsub 120 vrot vadd aload pop translate 180 rotate tile-T-2 grestore

    gsave 3 {tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate gsave tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-P-encloser-points-2 dup 0 get exch 2 get vsub vadd aload pop translate tile-F-2 grestore tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-H-encloser-points-2 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate} repeat grestore

    gsave 2 {tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate
             gsave tile-P-encloser-points-2 dup 0 get exch 2 get vsub aload pop translate tile-P-2
             grestore
             tile-H-encloser-points-2 dup 2 get exch 0 get vsub tile-H-encloser-points-2 dup 4 get exch 2 get vsub dup vadd vadd aload pop translate -120 rotate
            } repeat
    tile-H-encloser-points-2 dup 2 get exch 0 get vsub aload pop translate gsave 180 rotate tile-P-2
    grestore
    grestore




    %%%TILE-H-3

    {draw-tiles-p {gsave tile-H-encloser-points-2 0 get tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot vadd aload pop translate tile-H-2 tile-H-encloser-points-2 2 get aload pop translate tile-H-2 grestore gsave tile-H-encloser-points-2 4 get dup vadd tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot vadd aload pop translate -120 rotate tile-H-2 grestore gsave tile-H-encloser-points-2 dup 2 get exch 4 get vadd aload pop translate 180 rotate tile-T-2 grestore gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat grestore gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat tile-H-encloser-points-2 2 get aload pop translate gsave 180 rotate tile-P-2 grestore grestore} if draw-enclosers-p {tile-H-encloser-3} if}

    %%%

{

    {
        gsave
        tile-H-encloser-points-2 0 get tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot vadd aload pop translate tile-H-2 tile-H-encloser-points-2 2 get aload pop translate tile-H-2
        grestore

        gsave
        tile-H-encloser-points-2 4 get dup vadd tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot vadd aload pop translate -120 rotate tile-H-2
        grestore

        gsave
        tile-H-encloser-points-2 dup 2 get exch 4 get vadd aload pop translate 180 rotate tile-T-2
        grestore

        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate
        3 {
            tile-H-encloser-points-2 2 get aload pop translate
            gsave
            tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2
            grestore
            tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate
        } repeat
        grestore

        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate
        2 {
            tile-H-encloser-points-2 2 get aload pop translate
            gsave
            tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2
            grestore
            tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate
        }
        repeat
        tile-H-encloser-points-2 2 get aload pop translate
        gsave
        180 rotate tile-P-2
        grestore
        grestore
    }



    if draw-enclosers-p {tile-H-encloser-3} if}



%%%%
tile-H-encloser-2
/FEP tile-F-encloser-points-1 def /HEP tile-H-encloser-points-1 def /PEP tile-P-encloser-points-1 def /H //tile-H-1 def /F //tile-F-1 def /P //tile-P-1 def /T //tile-T-1 def

tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot
tile-H-encloser-points-2 4 get vadd
tile-H-encloser-points-2 1 get vadd


gsave 
10 -10 translate
tile-H-1
180 rotate
tile-H-1
[0 0] tm
grestore

/draw-tiles-p true def
/draw-enclosers-p true def
/draw-arrows-p true def


/epts true def


{
    draw-tiles-p {
        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot  aload pop translate tile-H-2 tile-H-encloser-points-2 2 get aload pop translate tile-H-2
        grestore

        gsave
        tile-H-encloser-points-2 4 get dup vadd tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot vadd aload pop translate -120 rotate tile-H-2
        grestore


        %%% find tile T
        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot  aload pop translate
        gsave
        tile-H-encloser-points-2 4 get aload pop translate

        gsave
        tile-F-encloser-points-1 dup 0 get exch 2 get vsub 120 vrot aload pop translate

        gsave
        -60 rotate tile-H-1
        

        tile-H-encloser-points-2 dup 2 get exch 4 get vadd aload pop translate 180 rotate tile-T-2 grestore

        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {
            tile-H-encloser-points-2 2 get aload pop translate
            gsave
            tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2
            grestore
            tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate
        } repeat
        grestore

        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {
            tile-H-encloser-points-2 2 get aload pop translate
            gsave
            tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2
            grestore
            tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate
        } repeat
        tile-H-encloser-points-2 2 get aload pop translate
        gsave
        180 rotate tile-P-2
        grestore
        grestore
    }


    if draw-enclosers-p {tile-H-encloser-3} if}




{
    draw-tiles-p {

        gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 0 get vadd aload pop translate tile-H-encloser-points-2 2 get aload pop translate tile-H-2 grestore

        gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 4 get dup vadd vadd aload pop translate -120 rotate tile-H-2 grestore

        gsave
        tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot
        tile-H-encloser-points-2 4 get vadd
        tile-F-encloser-points-1 dup 0 get exch 2 get vsub 120 vrot vadd

 aload pop translate -60 rotate [ 0 0 ] tt grestore

        gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat grestore

        gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat tile-H-encloser-points-2 2 get aload pop translate gsave 180 rotate tile-P-2 grestore grestore

        
    } if draw-enclosers-p {tile-H-encloser-3} if}




//tile-H-2
/FEP tile-F-encloser-points-1 def /HEP tile-H-encloser-points-1 def /PEP tile-P-encloser-points-1 def /H //tile-H-1 def /F //tile-F-1 def /P //tile-P-1 def /T //tile-T-1 def

     gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-1 0 get vadd aload pop translate tile-H-1 tile-H-encloser-points-1 2 get aload pop translate tile-H-1 grestore
     gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-1 4 get dup vadd vadd aload pop translate -120 rotate tile-H-1 grestore

     gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {tile-H-encloser-points-1 2 get aload pop translate gsave tile-H-encloser-points-1 2 get tile-P-encloser-points-1 2 get vsub aload pop translate tile-F-1 grestore tile-H-encloser-points-1 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat grestore

     gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {tile-H-encloser-points-1 2 get aload pop translate gsave tile-P-encloser-points-1 2 get vneg aload pop translate tile-P-1 grestore tile-H-encloser-points-1 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat tile-H-encloser-points-1 2 get aload pop translate gsave 180 rotate tile-P-1 grestore grestore


     gsave
     FEP dup 3 get exch 2 get vsub -120 vrot
     HEP 4 get vadd
     HEP 2 get vadd
     HEP dup 5 get exch 4 get vsub vadd
     aload pop translate -180 rotate T
     grestore

     % % aload pop translate -60 rotate


GS>//tile-H-3

/FEP tile-F-encloser-points-2 def /HEP tile-H-encloser-points-2 def /PEP tile-P-encloser-points-2 def /H //tile-H-2 def /F //tile-F-2 def /P //tile-P-2 def /T //tile-T-2 def



     gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 0 get vadd aload pop translate tile-H-2 tile-H-encloser-points-2 2 get aload pop translate tile-H-2 grestore
     gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 4 get dup vadd vadd aload pop translate -120 rotate tile-H-2 grestore
     gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat grestore

     gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat tile-H-encloser-points-2 2 get aload pop translate gsave 180 rotate tile-P-2 grestore grestore

     gsave
     FEP dup 3 get exch 2 get vsub -120 vrot
     HEP 4 get vadd
     dup ty

     FEP dup 3 get exch 2 get vsub 180 vrot vadd dup ty



     %%%tile-F-encloser-points-1 dup 0 get exch 2 get vsub 120 vrot vadd

     aload pop translate -60 rotate tile-H-1

     grestore

     T0 at [19.7534256 6.24012804]



                     gsave
                FEP dup 3 get exch 2 get vsub -120 vrot
                HEP 4 get vadd
                FEP dup 3 get exch 2 get vsub 180 vrot vadd 



                %%%tile-F-encloser-points-1 dup 0 get exch 2 get vsub 120 vrot vadd

                aload pop translate -60 rotate tile-H-1

                grestore




//tile-H-2

3 dup scale

gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot
tile-H-encloser-points-1 0 get vadd aload pop translate tile-H-1
tile-H-encloser-points-1 2 get aload pop translate tile-H-1 grestore

gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot
tile-H-encloser-points-1 4 get dup vadd vadd aload pop translate -120
rotate tile-H-1 grestore

gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120
vrot aload pop translate 3 {tile-H-encloser-points-1 2 get aload pop
translate gsave tile-H-encloser-points-1 2 get
tile-P-encloser-points-1 2 get vsub aload pop translate tile-F-1
grestore tile-H-encloser-points-1 dup 4 get dup vadd exch 2 get vsub
aload pop translate -120 rotate} repeat grestore gsave
tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot aload pop
translate 2 {tile-H-encloser-points-1 2 get aload pop translate gsave
tile-P-encloser-points-1 2 get vneg aload pop translate tile-P-1
grestore tile-H-encloser-points-1 dup 4 get dup vadd exch 2 get vsub
aload pop translate -120 rotate} repeat tile-H-encloser-points-1 2 get
aload pop translate gsave 180 rotate tile-P-1 grestore grestore


gsave
tile-F-encloser-points-1 dup 3 get exch 2 get vsub -120 vrot dup tr
tile-H-encloser-points-1 2 get vadd  dup tg
tile-H-encloser-points-1 5 get vadd  dup tb
 aload pop translate 180 rotate tile-T-1
grestore


//tile-H-3

2 dup scale

gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot
tile-H-encloser-points-2 0 get vadd aload pop translate tile-H-2
tile-H-encloser-points-2 2 get aload pop translate tile-H-2 grestore

gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot
tile-H-encloser-points-2 4 get dup vadd vadd aload pop translate -120
rotate tile-H-2 grestore

gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot
aload pop translate 3 {tile-H-encloser-points-2 2 get aload pop
translate gsave tile-H-encloser-points-2 2 get
tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2
grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub
aload pop translate -120 rotate} repeat grestore 

gsave
tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate

 2 {
tile-H-encloser-points-2 2 get aload pop translate
 gsave

tile-P-encloser-points-2 2 get vneg aload pop translate

 tile-P-2
grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub
aload pop translate -120 rotate} repeat tile-H-encloser-points-2 2 get
aload pop translate gsave 180 rotate tile-P-2 grestore grestore


gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 4 get vadd tile-F-encloser-points-2 dup 3 get exch 2 get vsub 180 vrot vadd aload pop translate 180 rotate tile-T-2 grestore 

gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 2 get vadd tile-H-encloser-points-2 5 get vadd aload pop translate 180 rotate tile-T-2 grestore



//tile-P-2

gsave tile-F-encloser-points-1 dup 0 get exch 2 get vsub -60 vrot
aload pop translate -60 rotate tile-F-1 grestore

gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -60 vrot aload pop translate 60 rotate tile-H-1 grestore

gsave tile-F-encloser-points-1 dup 3 get exch 2 get vsub -60 vrot tile-H-encloser-points-1 dup 4 get exch 0 get vsub vadd
tile-P-encloser-points-1 dup 0 get exch 2 get vsub 60 vrot vadd dup aload pop translate 60 rotate tile-P-1 grestore

gsave tile-H-encloser-points-1 dup 2 get exch 0 get vsub vadd dup aload pop translate 120 rotate tile-H-1 grestore


gsave 

tile-H-encloser-points-1 dup 2 get exch 0 get vsub 120 vrot vadd
tile-F-encloser-points-1 dup 0 get exch 3 get vsub 120 vrot vadd

aload pop translate 120 rotate tile-F-1 grestore


   } if draw-enclosers-p {tile-P-encloser-2} if}


//tile-H-3

1.5 dup scale
gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 0 get vadd aload pop translate tile-H-2 tile-H-encloser-points-2 2 get aload pop translate tile-H-2 grestore gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 4 get dup vadd vadd aload pop translate -120 rotate tile-H-2 grestore

gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 2 get vadd tile-H-encloser-points-2 5 get vadd aload pop translate 180 rotate tile-T-2 grestore

 gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat grestore gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat tile-H-encloser-points-2 2 get aload pop translate gsave 180 rotate tile-P-2 grestore grestore} if draw-enclosers-p {tile-H-encloser-3} if}


gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot tile-H-encloser-points-2 2 get vadd tile-H-encloser-points-2 5 get vadd aload pop translate 180 rotate % at this point we call T

tile-H-encloser-points-2 dup 5 get exch 4 get vsub

tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot vadd

 aload pop translate tile-H-1 grestore

 gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 3 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-H-encloser-points-2 2 get tile-P-encloser-points-2 2 get vsub aload pop translate tile-F-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat grestore gsave tile-F-encloser-points-2 dup 3 get exch 2 get vsub -120 vrot aload pop translate 2 {tile-H-encloser-points-2 2 get aload pop translate gsave tile-P-encloser-points-2 2 get vneg aload pop translate tile-P-2 grestore tile-H-encloser-points-2 dup 4 get dup vadd exch 2 get vsub aload pop translate -120 rotate} repeat tile-H-encloser-points-2 2 get aload pop translate gsave 180 rotate tile-P-2 grestore grestore} if draw-enclosers-p {tile-H-encloser-3} if}

